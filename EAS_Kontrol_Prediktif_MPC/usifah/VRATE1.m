function YVAP=VRATE1(NT,NF,XLIQ,HL,HLOLD,HV,HLB,Qreb,VB,F,R,HVB,HLF,HLD,DELTA,M)
%NT=31;NF=3;VB=74384;F=22500;R=1.345;...
%HVRB=5666;HLF=47367;HLD=43545;DELTA=34;
%XLIQ=[9 8 89 7 8 9 8 6 7 6 56 45 6 8 898 98 88 5 6 78 89 8 9 6 5 6 4 7 87 78 89];
%HL=[78 9 9 98 8 9 6 56 6 4 45 65 7 87 98 89 34 45 44 54 6 7 67 67 6 43 3 4 65 5 6];
%HLOLD=[88 7 9 87 5 56 44 33 55 66 6 76 87 98 45 34 5 545 5 5 65 3 2 3 4 56 56 56 5 6 54];
%HV=[12 3 43 4 54 6 7 87 9 8 67 8 989 56 445 4 4 5 6 7 78 8778 78 5 76 4 2 1 45 65 776];
%M=[90 7 67 454 76 78 8 67 45 34 23 32 32 45 5 56 7 67 78 89 56 45 56 78 78 6 2 3 45 56 56];
%
% PERHITUNGAN LAJU ALIR UAP
%
N=1;
HLN1=HL(N+1);
XLIQN1=XLIQ(N+1);
MN=M(N);
HLN=HL(N);
HLOLDN=HLOLD(N);
HVN=HV(N);
YVAP(N)=(XLIQN1*(HLN1-HLN)+VB*(HVB-HLN)-MN*(HLN-HLOLDN)/DELTA)/(HVN-HLN);
%YVAP(N)=(XLIQN1*(HLN1-HLB)+Qreb-MN*(HLN-HLOLDN)/DELTA)/(HVN-HLN1);
K=NF-1;
for N=2:K
    HLN1=HL(N+1);
    XLIQN1=XLIQ(N+1);
    MN=M(N);
    HLN=HL(N);
    HLOLDN=HLOLD(N);
    HVN=HV(N);
    YVAPn=YVAP(N-1);
    HVn=HV(N-1);
    YVAP(N)=(XLIQN1*(HLN1-HLN)+YVAPn*(HVn-HLN)-MN*(HLN-HLOLDN)/DELTA)/(HVN-HLN);
    %YVAP(N)=(XLIQ(N+1)*(HL(N+1)-HLB)+Qreb-M(N)*(HL(N)-HLOLD(N))/DELTA)/(HVB-HL(N+1));
    %
end
N=NF;
HLN1=HL(N+1);
XLIQN1=XLIQ(N+1);
MN=M(N);
HLN=HL(N);
HLOLDN=HLOLD(N);
HVN=HV(N);
YVAPn=YVAP(N-1);
HVn=HV(N-1);
YVAP(N)=(XLIQN1*(HLN1-HLN)+YVAPn*(HVn-HLN)+F*(HLF-HLN)-MN*(HLN-HLOLDN)/DELTA)/(HVN-HLN);
%YVAP(N)=(XLIQN1)*(HLN1)-HLB)+Qreb-M(N)*(HL(N)-HLOLD(N)+F*HLF)/DELTA)/(HVB-HL(N+1));N=NT;
L=NT-1;
H=NF+1;
for N=H:L
    HLN1=HL(N+1);
    XLIQN1=XLIQ(N+1);
    MN=M(N);
    HLN=HL(N);
    HLOLDN=HLOLD(N);
    HVN=HV(N);
    YVAPn=YVAP(N-1);
    HVn=HV(N-1);
    YVAP(N)=(XLIQN1*(HLN1-HLN)+YVAPn*(HVn-HLN)-MN*(HLN-HLOLDN)/DELTA)/(HVN-HLN);
end
N=NT;
MN=M(N);
HLN=HL(N);
HLOLDN=HLOLD(N);
HVN=HV(N);
YVAPn=YVAP(N-1);
HVn=HV(N-1);
YVAP(N)=(R*(HLD-HLN)+YVAPn*(HVn-HLN)-MN*(HLN-HLOLDN)/DELTA)/(HVN-HLN);
%YVAP(N)=(XLIQN1*(HL(N+1)-HLB)+Qreb-M(N)*(HL(N)-HLOLD(N)+F*HLF)/DELTA)/(HVB-HL(N+1));
YVAP;

      